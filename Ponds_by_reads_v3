library(tidyverse)
setwd("C:/Users/agb214/R files/ARG Project/data/reads/")

reads = read_tsv("combined_read_abundance_taxonomy.tsv", 
                 col_names = c("superkingdom","phylum","class","order","family","genus","species",
                               "count","sample","farm","rel_abund")) 

reads_by_genus = reads %>%
  group_by(sample) %>%
  count(genus) %>%
  mutate(rel_abund = n/sum(n)) %>%
  select(-n) %>%
  ungroup()
